version: "2026.1"

# Global defaults for all agents
defaults:
  retention_days: 90
  signing_enabled: true
  log_level: "metadata_only"  # metadata_only, full_payload

# Rules for forensic risk tagging
policies:
  - id: "critical-infra"
    match_methods: ["aws:*", "gcp:*", "kubernetes:*"]
    risk_level: "high"

  - id: "financial-ops"
    match_methods: ["stripe:*", "plaid:transfer_money"]
    risk_level: "critical"
    # Example: Flag transactions over $1000 as critical
    conditions:
      - key: "amount"
        operator: "gt"  # Supported operators: eq, gt, lt, gte, lte
        value: "1000"

  - id: "read-only-knowledge"
    match_methods: ["google_search:*", "slack:search"]
    risk_level: "low"
    log_level: "full_payload"
